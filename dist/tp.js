!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.TP=e()}(this,function(){"use strict";var s=["pending"],p=["reject"],h=["resolve"],v="function";function d(n){}function y(n){var e,t=s,o=null,r=[],c=d,u=(e=function(n,e){o=e,(c=function(t){setTimeout(function(){for(var n,e=0;n=r[e++];)a(n[1],n[0],t);r.length=0},0)}.bind(null,(t=n)[0]))()},function(){e&&e.apply(this,arguments),e=null});function i(n){u(h,n)}function f(n){u(p,n)}var l={get status(){return t[0]},get value(){return o},catch:function(n){return l.then(null,n)},then:function(n,e){var t=y.deferred();return r.push([t,{resolve:n,reject:e}]),c(),t.promise}};function a(n,u,e){var t=n[e],r=u[e];try{typeof t==v?function n(e){var t;var r=(o=n,c=u.reject,{resolve:function(){o&&o.apply(this,arguments),o=c=null},reject:function(){c&&c.apply(this,arguments),o=c=null}});var o,c;if(e===u.promise)throw TypeError("promise can`t return itself");try{e===Object(e)&&typeof(t=e.then)===v?t.call(e,r.resolve,r.reject):u.resolve(e)}catch(n){r.reject(n)}}(t(o)):r(o)}catch(n){u.reject(n)}}if(typeof n==v)try{n.call(l,i,f)}catch(n){f(n)}else i(n);return l}return y.all=function(c){return new y(function(t,n){var r=[],o=0;c.forEach(function(n,e){n.then(function(n,e){r[n]=e,++o==c.length&&t(r)}.bind(n,e))})})},y.race=function(n){return new y(function(e,t){n.forEach(function(n){n.then(e,t)})})},y.reject=function(t){return new y(function(n,e){e(t)})},y.resolve=function(e){return new y(function(n){n(e)})},y.deferred=function(){var t,r;return{promise:y(function(n,e){t=n,r=e}),resolve:t,reject:r}},y});
